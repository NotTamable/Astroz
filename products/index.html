<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - Astroz</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="navbar"></div>
    <main>
        <h2>Our Products</h2>
        <div id="products-container"></div>
    </main>
    <div class="footer">
        <p>&copy; 2023 Astroz</p>
    </div>
    <script src="products.js"></script>
    <script>
        fetch('../navbar.html')
            .then(response => response.text())
            .then(data => document.getElementById('navbar').innerHTML = data);

        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('search');
        if (searchQuery) {
            const productsContainer = document.getElementById('products-container');
            productsContainer.innerHTML = '';
            const filteredProducts = products.filter(product => 
                product.name.toLowerCase().includes(searchQuery.toLowerCase())
            );
            filteredProducts.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'product';
                productDiv.dataset.id = product.id;

                const productImage = document.createElement('img');
                productImage.src = `/ProductImages/${product.name.replace(/\s+/g, '')}.webp`;
                productImage.alt = product.name;

                const productName = document.createElement('h3');
                productName.textContent = product.name;

                const productPrice = document.createElement('p');
                productPrice.className = 'price';
                const displayedPrice = (product.price * 0.8).toFixed(2); // 20% less
                productPrice.textContent = `Â£${displayedPrice}`;

                productDiv.appendChild(productImage);
                productDiv.appendChild(productName);
                productDiv.appendChild(productPrice);

                productDiv.addEventListener('click', function() {
                    window.location.href = `product/index.html?id=${product.id}`;
                });

                productsContainer.appendChild(productDiv);
            });
        }
    </script>
</body>
</html>
